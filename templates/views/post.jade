extends ../layouts/default
	
block authorInfo
	if data.post.authors && data.post.authors.length
		each auth in data.post.authors
			.author
				- var authorImageUrl = auth.authorImage.exists ? auth.authorImage.url || ('/authors/images/' + auth.authorImage.filename) : '';
				img(src=authorImageUrl).avatar 
				.author-info
					.name=auth.authorName
					.brief=auth.introduction.brief||'此处应有一段简短的自述。'

block content
	link(href="/styles/site/post.min.css", rel="stylesheet")
	.container.container-post: .row
		.main-col.col-md-8
			.fill-space
			article
				if !data.post
					h2 Invalid Post.
				else
					header
						h1= data.post.title
						.post-prop-panel
							if data.post.authors && data.post.authors.length	
								div.post-prop
									each auth, auth_i in data.post.authors
										a(href='/author/' + auth.slug)= auth.authorName
										if auth_i < data.post.authors.length - 1
											| , 
										else
											| 
							if data.post.publishedDate 
								div.post-prop  	
									| #{data.post._.publishedDate.format('YYYY年M月D日')}
							if data.post.categories && data.post.categories.length
								div.post-prop
									each cat, cat_i in data.post.categories
										a(href='/articles/' + cat.key)= cat.name
										if cat_i < data.post.categories.length - 1
											| , 
										else
											| 
					if (data.post.postThumbnailImage.exists)
						- var postUrl = data.post.postThumbnailImage.url || ('/articles/post/images/' + data.post.postThumbnailImage.filename);
						div(style="background-image:url('" + postUrl + "');").post-thumbnail
					blockquote.post-abstract
						div!=data.post.content.abstract
					.post-body
						!= data.post.content.full
					.hidden-md.hidden-lg.authors-container
						header 作者
						block authorInfo
					.post-editor-note
						header 编辑手札
						.edtor-note!=data.post.content.editorNote||'<p>一段来自己编辑们的评论。</p><p>可能有多行。</p>'
					.post-copyright 
						本文内同为骚也团队原创，未经骚也及原作者授权，任何个人或组织不得抄袭、转载本文内容。任何个人或组织若有意愿使用本文任何原创内容，
						请发邮件至 #[a(href="mailto:mail@saoye.me") mail@saoye.me]，并注明用途。所有原创作品版权受《中华人民共和国著作权法》、Canadian Copyright Act等法律法规保护。
			.fill-space.hidden-md.hidden-lg
		section.col-md-4.side-col 
			.authors-container
				header.hidden-sm.hidden-xs 作者
				.hidden-sm.hidden-xs
					block authorInfo
				if (data.authorPosts && data.authorPosts.length > 0)
					.recent-posts
						header 最近文章
						ul
							each authorPost in data.authorPosts
								li.author-post
									a(href='/articles/post/' + authorPost.slug)
										= authorPost.title + ' - '
										span.author-post-date=authorPost._.publishedDate.format('YYYY.MM.DD')
